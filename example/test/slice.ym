__primitive__(add) :+(a I32, b I32) I32
__primitive__(sub) :-(a I32, b I32) I32
__primitive__(mod) :%(a I32, b I32) I32
__primitive__(mul) :*(a I32, b I32) I32
__primitive__(int_div) ://(a I32, b I32) I32
__primitive__(icmp_eq) :==(a I32, b I32) Bool
__primitive__(icmp_gt) :>(a I32, b I32) Bool

__primitive__(slice_size) size<T>(arr T[]) I32
__primitive__(slice_ptr) ptr<T>(arr T[]) T*
__primitive__(get_at) :[]<T>(ptr T*, offset I32) T
__primitive__(set_at) set_at<T>(ptr T*, offset I32, val T) T
__primitive__(slice_dup) dup_internal<T>(arr T[], extra I32) T[]

__primitive__(libc) puts(str U8*) I32
__primitive__(libc) __varargs__ printf(format U8*) I32

fn copy<T>(source T*, dest T*, amount I32)
  count I32 = amount
  while count > 0
    count = count - 1
    dest.set_at(count, source[count])
  end
end

fn dup<T>(arr T[], extra I32) T[]
  dup_t T[] = arr.dup_internal(extra)
  copy(arr.ptr, dup_t.ptr, arr.size)
  return dup_t
end

fn dup_append<T>(arr T[], last T) T[]
  dup_t T[] = arr.dup_internal(1)
  copy(arr.ptr, dup_t.ptr, arr.size)
  dup_t.ptr.set_at(arr.size, last)
  return dup_t
end

fn c_str(str U8[]) U8[] = str.dup_append(?\0)

fn hello()
  a U8[] = U8[?h, ?e, ?l, ?l, ?o]
  printf("string: %s\n", a.c_str)
  printf("size of a: %d\n", a.size)
  printf("size of a.c_str: %d\n", a.c_str.size)
  printf("ptr of a: %p\n", a.ptr)
  return
end

fn main() I32
  hello()
  return 0
end
